$def with (open_courses, user_info)

$#
$# This file is part of INGInious. See the LICENSE and the COPYRIGHTS files for
$# more information about the licensing of this file.
$#

$var title: $:_("Course list")

$def NavbarF():
    <ol class="nav navbar-nav navbar-breadcrumb">
        <li class="active"><a href="#" class="nav-link"><i class="fa fa-th-list fa-fw"></i> $:_("Course list")
            <span class="sr-only">$:_("(current)")</span></a></li>
    </ol>
$var Navbar: $:NavbarF()

$# Left column content
$def ColumnF():
    $if not user_manager.session_logged_in():
        $:include.signin_button()
    $else:
        <h3>$:_("Public courses")</h3>
        <div class="alert alert-warning" role="alert">
            $:_("This page lists all the courses that are available now. If you are a course administrator, go to your 'My courses' page to see all of them.")
        </div>
        <div class="list-group">
            <a class="list-group-item list-group-item-info" href="$get_homepath()/mycourses">
                <i class="fa fa-fw fa-th-list"></i>
                $:_("My courses / Register for a course")
            </a>
        </div>
$var Column: $:ColumnF()

$# Start content
<h2>$:_("Course list")</h2>
<div class="row">

    $ username = user_manager.session_username()
    $for courseid, course in open_courses.items():
        $ no_display_filter = not user_manager.course_is_user_registered(course, username) and not course.allow_preview()
        $ no_display_lti_filter =  course.lti_send_back_grade() or no_display_filter
        $ no_display = (no_display_lti_filter if course.is_lti() else no_display_filter) and not user_manager.has_admin_rights_on_course(course)
        <div class="col-sm-6">
            <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title"><a href="$('#' if no_display else (get_homepath()+'/course/'+courseid))"></a>$course.get_name(user_manager.session_language())</a></h5>
                    $if course.is_lti():
                        <h6 class="card-subtitle mb-2 text-muted">$:_("'External platform'") <i data-toggle="tooltip" title=$:_("'External platform'") data-placement="top" class="pull-right fa fa-fw fa-external-link"></i></h6>
                    $if course.is_registration_possible(user_info):
                        <h6 class="card-subtitle mb-2 text-muted">$:_("'Auto-registration'") <i data-toggle="tooltip" title=$:_("'Auto-registration'") data-placement="top" class="pull-right fa fa-fw fa-user"></i></h6>
                    $if course.is_password_needed_for_registration():
                        <h6 class="card-subtitle mb-2 text-muted">$:_("'Password needed'") <i data-toggle="tooltip" title=$:_("'Password needed'") data-placement="top" class="pull-right fa fa-fw fa-key"></i></h6>
                </div>
            </div>
        </div>
</div>